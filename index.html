<html>
<head>
<link rel="stylesheet" href="grid.css" type="text/css"  />
</head>

<body>
<button onClick=propagate()> Start Propagation </button>









<script>

var GRID_DIMENSION = 20;

//var lastClicked;
allClicked = [];


// initializes empty grid 
var initializeGrid = function() {
gridArray =[]
 for (var i=1;i<=GRID_DIMENSION;i++) {
     gridArray[i] = [];
  }
  return gridArray;
}


// creates clickable grid

var grid = clickableGrid(GRID_DIMENSION,GRID_DIMENSION);


document.body.appendChild(grid);
     

// creates clickable grid      
function clickableGrid( rows, cols ){
    var i=0;
    var grid = document.createElement('table');
    gridArray = initializeGrid();
    grid.className = 'grid';
    grid.id = 'myGrid';
    for (var r=1;r<=rows;++r){
        var tr = grid.appendChild(document.createElement('tr'));
        for (var c=1;c<=cols;++c){
            var cell = tr.appendChild(document.createElement('td'));
            cell.innerHTML = ++i;
            cell.innerValue = i;
            gridArray[r][c]=false;
            cell.addEventListener('click',(function(el,r,c,i){
                return function(){
                	allClicked.push(i);
                	gridArray[r][c]=true;
                    el.className='clicked';
                }
            })(cell,r,c,i),false);
        }
    }
    return grid;
}


var getNeighborCount  = function(cellRow, cellColumn) {
    count=0;
    for ( var i=-1; i<= 1; i++) {
        for ( var j=-1; j<= 1; j++){
            if (!(i===0 && j===i) && isWithinBounds(cellRow+i, cellColumn+j) && gridArray[cellRow+i][cellColumn+j])
                count++;
        }
    }

    return count;
    console.log("Count is ", count);
}


var isWithinBounds = function(cellRow, cellColumn) {
    return  ( (cellRow >= 1 && cellRow <= GRID_DIMENSION) && (cellColumn >= 1 && cellColumn <= GRID_DIMENSION) )
}


var propagate =function(){

nextStategridArray =[]
 for (var i=1;i<=GRID_DIMENSION;i++) {
     nextStategridArray[i] = [];
  }

	for (var i=1; i<=GRID_DIMENSION; i++) {
    	for (var j=1; j<=GRID_DIMENSION; j++){
    		if (( (getNeighborCount(i, j) === 3) || (getNeighborCount(i, j) === 2)) && gridArray[i][j] === true )
    			 { nextStategridArray[i][j]=true; 
    			//console.log(getNeighborCount(i, j));
    			//console.log(gridArray[i][j]);
    			//console.log("Found one alive");}
                }
    		else if (( getNeighborCount(i, j) === 3 ) && gridArray[i][j]===false )
    			{ nextStategridArray[i][j]=true; 
    			console.log(getNeighborCount(i, j));
    		//console.log(gridArray[i][j]);
//sole.log("Found one alive");} 
}
    		else 
    			{ nextStategridArray[i][j]=false; 
    		//console.log(getNeighborCount(i, j));
    		//	console.log(gridArray[i][j]);
    		//onsole.log("no one alive");} 
                }
    		}
}


    for (var i=1; i<=GRID_DIMENSION; i++) {
    	
   //	console.log("nextStategridArray #:",nextStategridArray[i]);
    	
	}

		for (var i=1; i<=GRID_DIMENSION; i++) {
    	for (var j=1; j<=GRID_DIMENSION; j++){
    			gridArray[i][j]=nextStategridArray[i][j];
    	}
    }



   var i=0;
   //ar grid = document.createElement('table');
   //rid.className = 'grid';
   grid =document.getElementById('myGrid');
    for (var r=1;r<=GRID_DIMENSION;r++){
        var tr = grid.rows[r-1];
        for (var c=1;c<=GRID_DIMENSION;c++){
            var cell = tr.cells[c-1];
            cell.innerHTML = ++i;
            cell.innerValue = i;
            cell.className ="";
            if (gridArray[r][c]) 
                {cell.className = 'clicked';
     //     console.log("added click class")}
 }
            else 
                {cell.className ="";
       //   console.log("did not add click class")}
   }
        }
    }
     //setInterval(propagate(),5000);



}
</script>

</body>
</html>